

# Cau 1 ------------------------------------------
age <- 25
info_age <- paste("Age: ",age)
print(info_age)
# b. T???o m???t bi???n ‘height’ và gán giá tr??? là 1.75. In giá tr??? c???a bi???n này.
height <- 1.75
print(height)

# c. Tính ch??? s??? BMI (Body Mass Index) b???ng cách s??? d???ng bi???n ‘weight’ (gi??? s??? có giá tr??? 70) và ‘height’. In k???t qu???.
weight <- 70
BMI <- weight / (height^2)
print(BMI)
#-------------------------------------------------








# Cau 2-----------------------------------------


# Nh???p giá tr??? c???a 'temperature' t??? ngý???i dùng
temperature <- as.numeric(readline("Nh???p vào nhi???t ð???: "))

if (!is.na(temperature)) {
  if (temperature > 30) {
    print("Nhi???t ð??? cao")
  } else {
    print("Nhi???t ð??? b??nh thý???ng")
  }
} else {
  print("Nh???p không h???p l???. Vui l??ng nh???p l???i.")
}



# b???ng c???u chýõng 7
for (i in 1:10) {
  result <- 7 * i
  print(paste("7 x", i, "=", result))
}


#  hàm factorial
factorial <- function(n) {
  if (n == 0) {
    return(1)
  } else {
    return(n * factorial(n - 1))
  }
}

# S??? d???ng hàm factorial
n <- 5 
result <- factorial(n)
print(paste("Giai th???a c???a", n, "là", result))

#---------------------------------------------------









#Cau 3----------------------------------------------

grades <- c(8, 7, 9, 10, 6.5)

# In vector 'grades'
print(grades)


# T???o matrix 3x3
matrix_data <- matrix(1:9, nrow = 3, ncol = 3)

print(matrix_data)


person_info <- list(
  name = "John Doe",
  age = 30,
  address = "123 Main Street, Cityville"
)

# In list
print(person_info)
# ---------------------------------------------------









#Cau 4 -----------------------------------------------

data <- data.frame(
  Tên = c("Alice", "Bob", "Charlie", "David", "Eve"),
  Tu???i = c(25, 30, 22, 35, 28),
  Gi???i_tính = c("N???", "Nam", "Nam", "Nam", "N???")
)

print(data)


# L???c ra các ngý???i có tu???i trên 30
people_over_30 <- subset(data, Tu???i > 30)

print(people_over_30)


# Sãp x???p tý???i l???n nh???
sorted_data <- data[order(-data$Tu???i), ]

# In danh sách ð?? s???p x???p
print(sorted_data)

#--------------------------------------------------------------










# Cau 5-------------------------------------------------------
# D??? li???u ði???m s??? c???a h???c sinh
scores <- c(85, 78, 92, 88, 76, 89, 91, 79, 83, 95, 77, 86, 90, 87, 84, 81, 94, 75, 82, 93)

# Tính giá tr??? trung b??nh
mean_score <- mean(scores)

# In giá tr??? trung b??nh
print(paste("Giá tr??? trung b??nh c???a ði???m s??? là:", mean_score))

# Tính ð??? l???ch chu???n
std_dev <- sd(scores)

# In ð??? l???ch chu???n
print(paste("Ð??? l???ch chu???n c???a ði???m s??? là:", std_dev))


#---------------------------------------------------------------










#Cau 6---------------------------------------------------------

# T???o vector ch???a tên s???n ph???m
product_names <- c("Áo thun", "V??ng c???", "Qu???n jean", "Túi xách", "Giày")

# T???o vector ch???a lo???i s???n ph???m
product_types <- c("Th???i trang", "Ph??? ki???n", "Th???i trang", "Ph??? ki???n", "Th???i trang")

# Hi???n th??? d??? li???u
print("D??? li???u s???n ph???m:")
print(data.frame(Tên_s???n_ph???m = product_names, Lo???i_s???n_ph???m = product_types))


# T???o factor t??? vector lo???i s???n ph???m
product_types_factor <- factor(product_types)

# In factor lo???i s???n ph???m
print("Danh sách lo???i s???n ph???m:")
print(product_types_factor)


# Tính s??? lý???ng s???n ph???m cho m???i lo???i s???n ph???m
product_counts <- table(product_types_factor)

# V??? bi???u ð??? bar plot
barplot(product_counts, main = "S??? lý???ng s???n ph???m cho m???i lo???i s???n ph???m", xlab = "Lo???i s???n ph???m", ylab = "S??? lý???ng", col = "skyblue")

#-------------------------------------------------------------











#Cau 7 ---------------------------------------------------------

# T???o n???i dung d??? li???u
data_content <- "Tên, Tu???i
Alice, 25
Bob, 30
Charlie, 22
David, 35
Eve, 28"

# Ghi n???i dung vào t???p "data.txt"
writeLines(data_content, "data.txt")



# Ð???c d??? li???u t??? t???p "data.txt"
data <- read.csv("data.txt")

# Hi???n th??? d??? li???u
print(data)



# Ð???c d??? li???u t??? t???p "data.txt" vào m???t vector
data_lines <- readLines("data.txt")

# Tách d??ng d??? li???u thành các thành ph???n riêng bi???t
for (line in data_lines) {
  components <- strsplit(line, ",")[[1]]
  print(components)
}

#---------------------------------------------------------











#Cau 8--------------------------------------------------------
# T???o d??? li???u m???u
data <- data.frame(
  Month = c("Tháng 1", "Tháng 2", "Tháng 3"),
  Sales = c(1000, 1200, 800)
)
# In d??? li???u
print(data)

#-------------------------------------------------------------













# cau 9-----------------------------------------------------------

# T???o DataFrame
data <- data.frame(
  Ten = c("Alice", "Bob", "Charlie", "David", "Eve", "Bob"),
  Tuoi = c(25, 30, NA, 35, 28, 30),
  Diem = c(85, 78, 92, 88, NA, 78),
  Ngay_sinh = c("15/5/1997", "20/2/1992", "10/9/1995", "30/11/1990", NA, "20/2/1992")
)

# Hi???n th??? DataFrame
print(data)

# Ki???m tra và lo???i b??? d??? li???u l???p
data <- data[!duplicated(data), ]

# Ki???m tra và lo???i b??? các hàng có giá tr??? thi???u
data <- na.omit(data)

# Tính giá tr??? trung b??nh c???a tu???i và ði???m s???
tuoi_trung_binh <- mean(data$Tuoi)
diem_trung_binh <- mean(data$Diem)

# Hi???n th??? giá tr??? trung b??nh c???a tu???i và ði???m s???
print(paste("Tuoi trung binh:", tuoi_trung_binh))
print(paste("Diem trung binh:", diem_trung_binh))

#-------------------------------------------------------------------------








#Cau 3a -----------------------------------------------------------------
# Nhap xuat du lieu



# Hàm ki???m tra và yêu c???u ngý???i dùng nh???p m???t s??? nguyên
check_int <- function(prompt) {
  while (TRUE) {
    input <- readline(prompt)
    if (!is.na(as.integer(input))) {
      return(as.integer(input))
    } else {
      cat("Giá tr??? ph???i là s??? nguyên. Vui l??ng nh???p l???i.\n")
    }
  }
}

# Hàm ki???m tra và yêu c???u ngý???i dùng nh???p m???t s??? th???c
check_double <- function(prompt) {
  while (TRUE) {
    input <- readline(prompt)
    if (!is.na(as.double(input))) {
      return(as.double(input))
    } else {
      cat("Giá tr??? ph???i là s??? th???c. Vui l??ng nh???p l???i.\n")
    }
  }
}

# Hàm thêm s???n ph???m
add_products <- function() {
  product_list <- list()
  numb_of_products <- check_int("Nh???p s??? lý???ng s???n ph???m: ")
  
  for (i in 1:numb_of_products) {
    cat(sprintf("Nh???p thông tin s???n ph???m th??? %s:\n", i))
    
    pCode <- check_int("Nh???p m?? s???n ph???m: ")
    pName <- readline("Nh???p tên s???n ph???m: ")
    pPrice <- check_double("Nh???p giá s???n ph???m: ")
    
    product_list <- append(product_list, list(list(code = pCode, name = pName, price = pPrice)))
  }
  
  return(product_list)
}

# Hàm hi???n th??? s???n ph???m
show_products <- function(product_list) {
  cat("Danh sách s???n ph???m:\n")
  cat(sprintf("%-8s %-12s %-5s\n", "M?? SP", "Tên SP", "Giá Bán"))
  for (product in product_list) {
    cat(sprintf("%-8s %-12s %-5.2f\n", product$code, product$name, product$price))
  }
}

options(warn = -1)
# S??? d???ng các hàm ð??? thêm và hi???n th??? s???n ph???m
products <- add_products()
show_products(products)

  
  



